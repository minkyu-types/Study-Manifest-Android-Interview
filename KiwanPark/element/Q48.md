## â“ **Q) 48. ì›¹ í˜ì´ì§€ë¥¼ ì–´ë–»ê²Œ ë Œë”ë§í•˜ë‚˜ìš”?**

---

### ğŸ“˜ ê°œë…
- **WebView**ëŠ” ì•± ë‚´ë¶€ì—ì„œ ì›¹ ì½˜í…ì¸ (HTML/CSS/JavaScript)ë¥¼ ì§ì ‘ í‘œì‹œí•˜ê³  ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆëŠ” **ë¯¸ë‹ˆ ë¸Œë¼ìš°ì €** ì—­í• ì„ í•©ë‹ˆë‹¤.  
- ë‹¤ì–‘í•œ ì•ˆë“œë¡œì´ë“œ ë²„ì „ì—ì„œ **ìµœì‹  WebView ê¸°ëŠ¥ì„ ì•ˆì „í•˜ê²Œ í™œìš©**í•˜ë ¤ë©´ AndroidX **WebKit** ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.  

---

### ğŸ”§ WebView ì´ˆê¸°í™”í•˜ê¸°

#### XML ë ˆì´ì•„ì›ƒì— WebView ì¶”ê°€
```xml
<!-- activity_main.xml -->
<WebView
    android:id="@+id/webView"
    android:layout_width="match_parent"
    android:layout_height="match_parent" />
```

#### ì½”ë“œë¡œ ìƒì„±í•˜ê¸°
```kotlin
// ê·¸ë¦¼ 123. WebView.kt
val webView = WebView(this)
setContentView(webView)
```

---

### ğŸŒ ì›¹ í˜ì´ì§€ ë¡œë“œí•˜ê¸°
- ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼ì´ í•„ìš”í•œ ê²½ìš° **AndroidManifest.xml**ì— ê¶Œí•œì„ ì¶”ê°€í•©ë‹ˆë‹¤.

```kotlin
// ê·¸ë¦¼ 124. WebView.kt
val webView: WebView = findViewById(R.id.webView)
webView.loadUrl("https://www.example.com")
```

```xml
<!-- AndroidManifest.xml -->
<uses-permission android:name="android.permission.INTERNET" />
```

---

### âš™ï¸ JavaScript í™œì„±í™”í•˜ê¸°
- ì›¹ ì½˜í…ì¸ ê°€ JSë¥¼ ìš”êµ¬í•˜ëŠ” ê²½ìš° **WebSettings**ë¡œ í™œì„±í™”í•©ë‹ˆë‹¤.

```kotlin
// ê·¸ë¦¼ 125. WebView.kt
val webSettings = webView.settings
webSettings.javaScriptEnabled = true
```

---

### ğŸ§­ WebView ë™ì‘ ì»¤ìŠ¤í…€í•˜ê¸°

#### í˜ì´ì§€ ë‚´ë¹„ê²Œì´ì…˜ ê°€ë¡œì±„ê¸°
- ì™¸ë¶€ ë¸Œë¼ìš°ì €ë¡œ ë‚˜ê°€ì§€ ì•Šê³  **WebView ë‚´ë¶€ì—ì„œ ë§í¬ ì´ë™ì„ ì²˜ë¦¬**í•˜ë ¤ë©´ `WebViewClient`ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.  
- **API 24 ë¯¸ë§Œ**ê³¼ **ì´ìƒ**ì—ì„œ ì˜¤ë²„ë¡œë“œê°€ ë‹¤ë¦…ë‹ˆë‹¤.

```kotlin
// ê·¸ë¦¼ 126. Navigation.kt
webView.webViewClient = object : WebViewClient() {
    // API 24 ë¯¸ë§Œ
    override fun shouldOverrideUrlLoading(view: WebView?, url: String?): Boolean {
        url?.let { view?.loadUrl(it) }
        return true // WebViewê°€ URL ë¡œë”©ì„ ì²˜ë¦¬
    }

    // API 24 ì´ìƒ
    override fun shouldOverrideUrlLoading(
        view: WebView?, request: WebResourceRequest?
    ): Boolean {
        request?.url?.let { view?.loadUrl(it.toString()) }
        return true // ì™¸ë¶€ ë¸Œë¼ìš°ì €ë¡œ ë‚˜ê°€ì§€ ì•Šë„ë¡ ë‚´ë¶€ ì²˜ë¦¬
    }
}
```

---

### â¬‡ï¸ ë‹¤ìš´ë¡œë“œ ì²˜ë¦¬í•˜ê¸°
- WebView ë‚´ì—ì„œ ë°œìƒí•˜ëŠ” **íŒŒì¼ ë‹¤ìš´ë¡œë“œ**ëŠ” `DownloadListener`ë¡œ ë°›ì•„ì„œ **DownloadManager**ì— ìœ„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```kotlin
// ê·¸ë¦¼ 127. DownloadListener.kt
webView.setDownloadListener { url, userAgent, contentDisposition, mimeType, contentLength ->
    // ì—¬ê¸°ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì²˜ë¦¬ (ì˜ˆ: DownloadManager ì‚¬ìš©)
    val request = DownloadManager.Request(Uri.parse(url))
    // ... (í•„ìš”í•œ DownloadManager ì„¤ì •) ...
    val downloadManager = getSystemService(Context.DOWNLOAD_SERVICE) as DownloadManager
    downloadManager.enqueue(request)
}
```

---

### ğŸ§ª WebViewì—ì„œ JavaScript ì‹¤í–‰í•˜ê¸°
- `evaluateJavascript`(API 19+) ë˜ëŠ” `loadUrl("javascript:...")` ë°©ì‹ìœ¼ë¡œ **JS ì£¼ì…/ì‹¤í–‰**ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```kotlin
// ê·¸ë¦¼ 128. JavaScript.kt
// ê¶Œì¥: API 19+
webView.evaluateJavascript(
    "document.body.style.backgroundColor = 'red';"
) { result ->
    Log.d("WebView", "JavaScript ì‹¤í–‰ ê²°ê³¼: $result")
}

// ì´ì „ ë°©ì‹ (ê²°ê³¼ ì½œë°± X)
// webView.loadUrl("javascript:document.body.style.backgroundColor = 'blue';")
```

---

### ğŸ”— JavaScript â†” ì•ˆë“œë¡œì´ë“œ ë°”ì¸ë”©(ê°œìš”)
- `addJavascriptInterface()`ë¡œ **Java/Kotlin ê°ì²´ë¥¼ JS ì»¨í…ìŠ¤íŠ¸ì— ë…¸ì¶œ**í•˜ì—¬, JSì—ì„œ ë„¤ì´í‹°ë¸Œ ê¸°ëŠ¥(Toast, Dialog ë“±)ì„ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
- (ë¬¸ì„œ ì˜ˆì‹œ: *ê·¸ë¦¼ 129. WebAppInterface.kt* â€” `@JavascriptInterface`ë¡œ ë©”ì„œë“œ ë…¸ì¶œ)

---

### ğŸ”’ ë³´ì•ˆ ê³ ë ¤ ì‚¬í•­
- í•„ìš”í•˜ì§€ ì•Šë‹¤ë©´ **JavaScript ë¹„í™œì„±í™”**ë¥¼ ìœ ì§€í•˜ì„¸ìš”.  
- `setAllowFileAccess()`, `setAllowFileAccessFromFileURLs()` ì‚¬ìš©ì€ ì‹ ì¤‘íˆ.  
- **XSS/URL ìŠ¤í‘¸í•‘ ë°©ì§€** ìœ„í•´ ì…ë ¥ ê²€ì¦ ë° URL ì •ì œ í•„ìˆ˜.  
- `@JavascriptInterface`ë¡œ ë…¸ì¶œí•˜ëŠ” ë©”ì„œë“œëŠ” **í‘œë©´ì ì„ ìµœì†Œí™”**í•˜ê³  ê²€ì¦/ê¶Œí•œ ì²´í¬ë¥¼ ì ìš©í•˜ì„¸ìš”.

---

### ğŸ§¾ ìš”ì•½
- WebViewëŠ” ì•± ë‚´ì—ì„œ ì›¹ì„ ë Œë”ë§í•˜ëŠ” ê¸°ë³¸ ì»´í¬ë„ŒíŠ¸ì´ë©°, `WebViewClient`ë¡œ ë‚´ë¹„ê²Œì´ì…˜ì„ ì»¤ìŠ¤í…€í•˜ê³  í•„ìš” ì‹œ JavaScriptë¥¼ í™œì„±í™”í•˜ì—¬ ì‚¬ìš©ì ê²½í—˜ì„ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
- ë‹¤ë§Œ **ë³´ì•ˆ/ì„±ëŠ¥ ì˜í–¥**ì„ í•­ìƒ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤.

---

### ğŸ’¬ ì‹¤ì „ ì§ˆë¬¸ (ë¬¸ì„œ ì›ë¬¸)
**Q) ì™¸ë¶€ ë§í¬ë¥¼ í´ë¦­í•  ë•Œ ì‚¬ìš©ìê°€ ì•±ì„ ë²—ì–´ë‚˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´  
WebView ë‚´ë¹„ê²Œì´ì…˜ì„ íš¨ê³¼ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì—ëŠ” ë¬´ì—‡ì´ ìˆëŠ”ì§€ ì„¤ëª…í•´ ì£¼ì„¸ìš”**

âœ… **ë‹µë³€**  
1) **`WebViewClient` ì§€ì •**: `shouldOverrideUrlLoading`ì„ êµ¬í˜„í•´ **ëª¨ë“  URL ë¡œë”©ì„ WebView ë‚´ë¶€ì—ì„œ ì²˜ë¦¬**í•˜ë„ë¡ í•©ë‹ˆë‹¤.  
   - **API 24 ë¯¸ë§Œ**: `(view, url)` ì˜¤ë²„ë¡œë“œì—ì„œ `view?.loadUrl(url)` ìˆ˜í–‰ í›„ `true` ë°˜í™˜.  
   - **API 24 ì´ìƒ**: `(view, request)` ì˜¤ë²„ë¡œë“œì—ì„œ `request.url`ì„ `loadUrl()`ë¡œ ì²˜ë¦¬ í›„ `true` ë°˜í™˜.  
2) **ë‹¤ìš´ë¡œë“œ ë§í¬ ëŒ€ì‘**: íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë§í¬ëŠ” `setDownloadListener`ì—ì„œ ë°›ì•„ **DownloadManager**ë¡œ ì²˜ë¦¬í•´ **ì™¸ë¶€ ì•± í˜¸ì¶œì„ ë°©ì§€**í•©ë‹ˆë‹¤.  
3) **ì—ëŸ¬/ë¦¬ë‹¤ì´ë ‰íŠ¸ ëŒ€ë¹„**: í•„ìš” ì‹œ `onPageStarted/onReceivedError` ë“±ì„ í•¨ê»˜ êµ¬í˜„í•´ **ì˜ë„ì¹˜ ì•Šì€ ì™¸ë¶€ ì´ë™**ì´ë‚˜ ì‹¤íŒ¨ ì¼€ì´ìŠ¤ë¥¼ ì œì–´í•©ë‹ˆë‹¤.  
4) **ë³´ì•ˆ ê²€ì¦**: ì´ë™ ëŒ€ìƒ **URL í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸/ìŠ¤í‚´ í•„í„°ë§**ê³¼ **HTTPS ê°•ì œ**ë¡œ í”¼ì‹±/ìŠ¤í‘¸í•‘ì„ ì˜ˆë°©í•©ë‹ˆë‹¤.

# ğŸŒ í¬ë¡œë¯¸ì›€(WebView) vs Jetpack WebView(ANDROIDX WebKit) â€” ì°¨ì´ì™€ ì½”ë“œ ì˜ˆì œ

> ìš”ì•½  
> - **í¬ë¡œë¯¸ì›€ WebView** = ì‹œìŠ¤í…œì— ë‚´ì¥ëœ `android.webkit.WebView` ë Œë”ë§ ì—”ì§„.  
> - **Jetpack WebView(ANDROIDX WebKit)** = ê°™ì€ ì—”ì§„ì„ ì“°ë˜, **`androidx.webkit.*` Compat API**ë¡œ **í•˜ìœ„ í˜¸í™˜ + ìµœì‹  ê¸°ëŠ¥ ë…¸ì¶œ/í† ê¸€**ì„ ì‰½ê²Œ í•´ì£¼ëŠ” **ë˜í¼/í™•ì¥ ë¼ì´ë¸ŒëŸ¬ë¦¬**.  
> - ì‹¤ë¬´ í¬ì¸íŠ¸ = **ê¸°ëŠ¥ ê°ì§€(`WebViewFeature`) + Compat ì„¤ì •**ë¡œ ë²„ì „ë³„ ë¶„ê¸°ë¥¼ ìµœì†Œí™”í•˜ê³ , ìµœì‹  ê¸°ëŠ¥(ë‹¤í¬ëª¨ë“œ, ì„¸ì´í”„ë¸Œë¼ìš°ì§•, ì„œë¹„ìŠ¤ì›Œì»¤, ë©”ì‹œì§€ ë¸Œë¦¬ì§€ ë“±)ì„ ì•ˆì •ì ìœ¼ë¡œ ì‚¬ìš©.

---

## 1) ì‹œìŠ¤í…œ í¬ë¡œë¯¸ì›€ WebView (ê¸°ë³¸ ì—”ì§„)
- **í´ë˜ìŠ¤**: `android.webkit.WebView`
- **ì—…ë°ì´íŠ¸ ê²½ë¡œ**: OS/Play ìŠ¤í† ì–´ì˜ *Android System WebView* ì•±ì„ í†µí•´ ì—”ì§„ ì—…ë°ì´íŠ¸
- **ì¥ì **: ëª¨ë“  ì•±ì´ ê³µí†µ ì—”ì§„ ì‚¬ìš© â†’ ë³´ì•ˆ íŒ¨ì¹˜/ì„±ëŠ¥ ê°œì„ ì´ ì¼ê´„ ë°˜ì˜
- **í•œê³„**: ìƒˆ ê¸°ëŠ¥/í”Œë˜ê·¸ì˜ **ë…¸ì¶œ íƒ€ì´ë°ì´ ê¸°ê¸°/OSì— ì¢…ì†**, ë²„ì „ë³„ ë¶„ê¸° ì½”ë“œê°€ ëŠ˜ì–´ë‚¨

### ê¸°ë³¸ ì‚¬ìš© ì˜ˆ
```xml
<!-- activity_main.xml -->
<WebView
    android:id="@+id/webView"
    android:layout_width="match_parent"
    android:layout_height="match_parent" />
```

```kotlin
// ê¸°ë³¸ ë¡œë“œ
val webView: WebView = findViewById(R.id.webView)
webView.settings.javaScriptEnabled = true
webView.loadUrl("https://www.example.com")
```

---

## 2) Jetpack WebView (ANDROIDX WebKit)
- **ì•„í‹°íŒ©íŠ¸**: `androidx.webkit:webkit:<version>`
- **í•µì‹¬ ì•„ì´ë””ì–´**: ê°™ì€ ì‹œìŠ¤í…œ WebView ì—”ì§„ì„ ì“°ì§€ë§Œ, **Compat ê³„ì¸µ**ìœ¼ë¡œ
  - í•˜ìœ„ OSì—ì„œë„ **ì¼ê´€ëœ API í‘œë©´** ì œê³µ
  - **ê¸°ëŠ¥ ì§€ì› ì—¬ë¶€ ê°ì§€**(`WebViewFeature.isFeatureSupported`)
  - **ì„¤ì •/ë™ì‘ì„ Compatë¡œ ì ìš©**(`WebSettingsCompat`, `WebViewCompat`, â€¦)

### Gradle ì¶”ê°€
```kotlin
dependencies {
    implementation("androidx.webkit:webkit:1.11.0") // ì˜ˆì‹œ ë²„ì „
}
```

---

## 3) ë²„ì „ë³„/ê¸°ëŠ¥ë³„ ë¶„ê¸° â€” â€œì—”ì§„ ê¸°ëŠ¥ ê°ì§€ â†’ ì•ˆì „í•˜ê²Œ ì‚¬ìš©â€
> íŒ¨í„´: `WebViewFeature.isFeatureSupported(FEATURE)` â†’ ì§€ì› ì‹œ Compat API í˜¸ì¶œ

### (A) ë‹¤í¬ ëª¨ë“œ ê°•ì œ(Force Dark)
```kotlin
val settings = webView.settings

if (WebViewFeature.isFeatureSupported(WebViewFeature.FORCE_DARK)) {
    // ì‹œìŠ¤í…œ ë‹¤í¬ëª¨ë“œ ëŒ€ì‘ ê°•ì œ
    WebSettingsCompat.setForceDark(
        settings,
        WebSettingsCompat.FORCE_DARK_ON
    )
}

// ë‹¤í¬ ì „ëµ (CSS/ì´ë¯¸ì§€ ë“± í¬í•¨ ë³€í™˜)
if (WebViewFeature.isFeatureSupported(WebViewFeature.FORCE_DARK_STRATEGY)) {
    WebSettingsCompat.setForceDarkStrategy(
        settings,
        WebSettingsCompat.DARK_STRATEGY_WEB_THEME_DARKENING_ONLY
        // or DARK_STRATEGY_PREFER_WEB_THEME_OVER_USER_AGENT_DARKENING
    )
}
```

### (B) Safe Browsing (í”¼ì‹±/ë©€ì›¨ì–´ íƒì§€)
```kotlin
if (WebViewFeature.isFeatureSupported(WebViewFeature.START_SAFE_BROWSING)) {
    WebViewCompat.startSafeBrowsing(this) { success ->
        // ì´ˆê¸°í™” ì„±ê³µ/ì‹¤íŒ¨ ë¡œê¹…
    }
}

// ìœ„í˜‘ ê°ì§€ì‹œ ì½œë°± (Compat)
webView.webViewClient = object : WebViewClientCompat() {
    override fun onSafeBrowsingHit(
        view: WebView,
        request: WebResourceRequest,
        threatType: Int,
        callback: SafeBrowsingResponseCompat
    ) {
        // ì°¨ë‹¨/ê³„ì† ë“± ì •ì±… ê²°ì •
        callback.backToSafety(true) // ë’¤ë¡œ ì´ë™ + ë³´ê³ 
        // callback.proceed(false)  // ê³„ì† ì§„í–‰ (ê¶Œì¥ X)
        // callback.showInterstitial(true)
    }
}
```

### (C) Service Worker (ì˜¤í”„ë¼ì¸/í”„ë¡ì‹±/ìºì‹±)
```kotlin
if (WebViewFeature.isFeatureSupported(WebViewFeature.SERVICE_WORKER_BASIC_USAGE)) {
    val controller = ServiceWorkerControllerCompat.getInstance()
    controller.setServiceWorkerClient(object : ServiceWorkerClientCompat() {
        override fun shouldInterceptRequest(request: WebResourceRequest): WebResourceResponse? {
            // í•„ìš”ì‹œ ìš”ì²­ ê°€ë¡œì±„ ìºì‹œ/í”„ë¡ì‹œ/ë¡œê¹…
            return null
        }
    })
}
```

### (D) WebMessage / JS â†” ë„¤ì´í‹°ë¸Œ ì–‘ë°©í–¥ ë©”ì‹œì§€ (postMessage)
- ìµœì‹  ìŠ¤í™ ê¸°ë°˜ ë©”ì‹œì§•. `addWebMessageListener` ì§€ì› ì‹œ **ë„ë©”ì¸ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸** ê¸°ë°˜ìœ¼ë¡œ ì•ˆì „í•˜ê²Œ ë¸Œë¦¬ì§•.
```kotlin
if (WebViewFeature.isFeatureSupported(WebViewFeature.WEB_MESSAGE_LISTENER)) {
    WebViewCompat.addWebMessageListener(
        webView,
        "AndroidBridge",                    // JSì—ì„œ ë…¸ì¶œë˜ëŠ” ê°ì²´ëª…
        setOf("https://www.example.com"),   // í—ˆìš© ì˜¤ë¦¬ì§„(í•„ìˆ˜)
        object : WebViewCompat.WebMessageListener {
            override fun onPostMessage(
                view: WebView,
                message: WebMessageCompat,
                sourceOrigin: Uri,
                isMainFrame: Boolean,
                replyProxy: JavaScriptReplyProxy
            ) {
                // JS â†’ ì•± ë©”ì‹œì§€ ìˆ˜ì‹ 
                val payload = message.data
                Log.d("Bridge", "from JS: $payload @ $sourceOrigin (main:$isMainFrame)")
                replyProxy.postMessage("Ack: $payload") // ì•± â†’ JS ì‘ë‹µ
            }
        }
    )
}
```

### (E) ì•ˆì „í•œ ë¡œì»¬ ë¦¬ì†ŒìŠ¤ ì œê³µ â€” `WebViewAssetLoader`
- ì•± ë²ˆë“¤/ë‚´ë¶€ ì €ì¥ íŒŒì¼ì„ **HTTPSì²˜ëŸ¼ ì•ˆì „í•œ ê°€ì§œ ë„ë©”ì¸**ìœ¼ë¡œ ë§¤í•‘í•´ ë¡œë“œ
```kotlin
val assetLoader = WebViewAssetLoader.Builder()
    .addPathHandler("/assets/", WebViewAssetLoader.AssetsPathHandler(this))
    .addPathHandler("/res/",    WebViewAssetLoader.ResourcesPathHandler(this))
    .build()

webView.webViewClient = object : WebViewClientCompat() {
    override fun shouldInterceptRequest(
        view: WebView,
        request: WebResourceRequest
    ): WebResourceResponse? {
        return assetLoader.shouldInterceptRequest(request.url)
    }
}

// ì˜ˆ: https://appassets.androidplatform.net/assets/www/index.html
webView.loadUrl("https://appassets.androidplatform.net/assets/www/index.html")
```

---

## 4) ì™¸ë¶€ ë§í¬ â€œì•± ì´íƒˆ ë°©ì§€â€ ë‚´ë¹„ê²Œì´ì…˜ ì²˜ë¦¬ (ì‹¤ì „ ì§ˆë¬¸ ëŒ€ì‘)
> **ëª©í‘œ**: ì‚¬ìš©ìê°€ ë§í¬ë¥¼ ëˆŒëŸ¬ë„ **í•­ìƒ WebView ë‚´ë¶€ì—ì„œ ì²˜ë¦¬**.  
> **ì „ëµ**: `WebViewClient`ì—ì„œ `shouldOverrideUrlLoading()` êµ¬í˜„ + **í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸/ìŠ¤í‚´ í•„í„°**.

```kotlin
webView.webViewClient = object : WebViewClientCompat() {

    // API 24 ë¯¸ë§Œ (Deprecated ì‹œê·¸ë‹ˆì²˜ì—ë„ ëŒ€ë¹„)
    override fun shouldOverrideUrlLoading(view: WebView?, url: String?): Boolean {
        val safe = url?.takeIf(::isAllowedUrl) ?: return true
        view?.loadUrl(safe)
        return true // ì™¸ë¶€ ë¸Œë¼ìš°ì €ë¡œ ê°€ì§€ ì•ŠìŒ
    }

    // API 24 ì´ìƒ
    override fun shouldOverrideUrlLoading(
        view: WebView,
        request: WebResourceRequest
    ): Boolean {
        val target = request.url.toString()
        if (!isAllowedUrl(target)) return true // ì°¨ë‹¨
        view.loadUrl(target)
        return true
    }

    override fun onReceivedError(
        view: WebView,
        request: WebResourceRequest,
        error: WebResourceErrorCompat
    ) {
        if (request.isForMainFrame) {
            // ì—ëŸ¬ í˜ì´ì§€/ë¦¬íŠ¸ë¼ì´ UI
        }
    }
}

// í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸/ìŠ¤í‚´ í•„í„°(ì˜ˆì‹œ)
fun isAllowedUrl(url: String): Boolean {
    val uri = Uri.parse(url)
    val allowedHosts = setOf("www.example.com", "m.example.com")
    val allowedSchemes = setOf("https") // http ì°¨ë‹¨
    return uri.scheme in allowedSchemes && uri.host in allowedHosts
}
```

> íŒŒì¼ ë‹¤ìš´ë¡œë“œê¹Œì§€ ë‚´ë¶€ ì²˜ë¦¬í•˜ë ¤ë©´ `DownloadListener` + `DownloadManager`ë¡œ ì´ì–´ì„œ ì²˜ë¦¬:
```kotlin
webView.setDownloadListener { url, ua, cd, mime, len ->
    val req = DownloadManager.Request(Uri.parse(url))
        .setNotificationVisibility(
            DownloadManager.Request.VISIBILITY_VISIBLE_NOTIFY_COMPLETED
        )
    val dm = getSystemService(Context.DOWNLOAD_SERVICE) as DownloadManager
    dm.enqueue(req)
}
```

---

## 5) ë³´ì•ˆ íŒ (í•„ìˆ˜ ì²´í¬ë¦¬ìŠ¤íŠ¸)
- **JS í•„ìš” ì‹œì—ë§Œ í™œì„±í™”**: `javaScriptEnabled = true` ë‚¨ë°œ ê¸ˆì§€  
- **ë„ë©”ì¸ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸**: ë©”ì‹œì§€ ë¸Œë¦¬ì§€/ë¦¬ë””ë ‰ì…˜/ë¦¬ì†ŒìŠ¤ ì¸í„°ì…‰íŠ¸ ì‹œ **í—ˆìš© ì˜¤ë¦¬ì§„** ëª…ì‹œ  
- **HTTP ì°¨ë‹¨/HTTPS ê°•ì œ**, Mixed Content ì •ì±… í™•ì¸  
- `addJavascriptInterface` ëŒ€ì‹  ê°€ëŠ¥í•˜ë©´ **`addWebMessageListener` + ì˜¤ë¦¬ì§„ ì œí•œ** ì„ í˜¸  
- íŒŒì¼ ì ‘ê·¼(`setAllowFileAccess*`)ì€ **ìµœì†Œ ê¶Œí•œ ì›ì¹™**  
- Safe Browsing ì´ˆê¸°í™” ë° `onSafeBrowsingHit`ì—ì„œ ì •ì±… ëª…í™•í™”

---

## 6) ì–´ë–¤ ê²ƒì„ ì“°ë©´ ë˜ë‚˜?
- **ë‹¨ìˆœ í‘œì‹œ/ê¸°ë³¸ ê¸°ëŠ¥**: ì‹œìŠ¤í…œ WebViewë§Œìœ¼ë¡œ ì¶©ë¶„  
- **ë²„ì „ ì°¨ì´ ì—†ëŠ” ì¼ê´€ API + ìµœì‹  ê¸°ëŠ¥ ì œì–´**: **Jetpack WebKit ê¶Œì¥**  
  - ì˜ˆ) ê°•ì œ ë‹¤í¬ëª¨ë“œ, ì„œë¹„ìŠ¤ì›Œì»¤, ì•ˆì „í•œ ë¡œì»¬ ë¦¬ì†ŒìŠ¤ ì„œë¹™, ë©”ì‹œì§€ ë¸Œë¦¬ì§€, ì„¸ì´í”„ë¸Œë¼ìš°ì§• ì½œë°± ë“±

---

## 7) ë¹ ë¥¸ ìŠ¤ë‹ˆí« ëª¨ìŒ

### (1) ë‹¤í¬ëª¨ë“œ í•œ ì¤„ ìš”ì•½
```kotlin
if (WebViewFeature.isFeatureSupported(WebViewFeature.FORCE_DARK))
    WebSettingsCompat.setForceDark(webView.settings, WebSettingsCompat.FORCE_DARK_ON)
```

### (2) ë©”ì‹œì§€ ë¸Œë¦¬ì§€(JSâ†”ì•±)
```kotlin
if (WebViewFeature.isFeatureSupported(WebViewFeature.WEB_MESSAGE_LISTENER)) {
    WebViewCompat.addWebMessageListener(webView, "Bridge", setOf("https://site"), object : WebViewCompat.WebMessageListener {
        override fun onPostMessage(v: WebView, msg: WebMessageCompat, origin: Uri, isMain: Boolean, reply: JavaScriptReplyProxy) {
            reply.postMessage("pong")
        }
    })
}
```

### (3) ì•ˆì „í•œ ìì‚° ì„œë¹™
```kotlin
val loader = WebViewAssetLoader.Builder()
    .addPathHandler("/assets/", WebViewAssetLoader.AssetsPathHandler(this))
    .build()

webView.webViewClient = object : WebViewClientCompat() {
    override fun shouldInterceptRequest(v: WebView, r: WebResourceRequest): WebResourceResponse? =
        loader.shouldInterceptRequest(r.url)
}
webView.loadUrl("https://appassets.androidplatform.net/assets/index.html")
```

---

## ê²°ë¡ 
- **í¬ë¡œë¯¸ì›€ WebView**ëŠ” â€œì—”ì§„â€, **Jetpack WebKit**ì€ â€œì—”ì§„ì„ ì œì–´/í™•ì¥í•˜ëŠ” í˜¸í™˜ì„± ë ˆì´ì–´â€.  
- ì‹¤ë¬´ì—ì„œëŠ” **`WebViewFeature`ë¡œ ì§€ì›ì—¬ë¶€ë¥¼ ê°ì§€**í•˜ê³ , **Compat APIë¡œ ê¸°ëŠ¥ì„ ì ìš©**í•˜ì—¬ **ë²„ì „ íŒŒí¸í™”**ë¥¼ ì¤„ì´ì„¸ìš”.  
- ì™¸ë¶€ ë§í¬/ë‹¤ìš´ë¡œë“œ/ë³´ì•ˆì€ **í•­ìƒ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì™€ ì •ì±…**ì„ ë¨¼ì € ì„¸ìš°ê³  êµ¬í˜„í•˜ì„¸ìš”.
